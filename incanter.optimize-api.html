<html>
  <head>
    <title>incanter.optimize API reference (Incanter)</title>
    <link href="static/favicon.png" rel="icon" />
    <link href="static/favicon.png" rel="shortcut icon" />
    <link media="all" type="text/css" href="static/clojure.css" rel="stylesheet" />
    <link media="all" type="text/css" href="static/wiki.css" rel="stylesheet" />
    <link media="all" type="text/css" href="static/internal.css" rel="stylesheet" />
    <!-- TODO: are we using these (from clojure.org)? If so, add the files -->
    <script src="file/view/code_highlighter.js" type="text/javascript"></script>
    <script src="file/view/clojure.js" type="text/javascript"></script>
    <style>.menuWrapper{height: 36px;}</style>
    <!--[if lte IE 6]>
    <link rel="stylesheet" href="http://www.wikispaces.com/_/2009051601/s/internal_ie.css" type="text/css" />
    <![endif]-->
  </head>
<!--
This document was auto-generated from the source by the clojure autodoc system.
To report errors or ask questions about the overall documentation structure, formatting,
etc., contact Tom Faulhaber (google mail name: tomfaulhaber).
For errors in the documentation of a particular namespace, contact the author of that
namespace.
-->
  <body>
    <div id="AllContentContainer">
      <div id="Header">
	<a id="Logo" href="index.html"><img alt="Clojure" height="100" width="100" src="static/clojure-icon.gif" /></a>
	<h1><a title="page header title" id="page-header" href="index.html">Incanter</a></h1>
      </div>
      <div id="leftcolumn"><div><div style="text-align: center;"></div>
<div class="menu">
  <div class="WikiCustomNav WikiElement wiki">
    <a class="wiki_link" href="index.html">Overview</a><br />
    <a class="wiki_link" href="api-index.html">API Index</a><br />
    <a class="wiki_link" href="#">Namespaces:</a>
    <ul id="left-sidebar-list">
      <li><a href="incanter.bayes-api.html" class="wiki_link">incanter.bayes</a></li><li><a href="incanter.censored-api.html" class="wiki_link">incanter.censored</a></li><li><a href="incanter.charts-api.html" class="wiki_link">incanter.charts</a></li><li><a href="incanter.chrono-api.html" class="wiki_link">incanter.chrono</a></li><li><a href="incanter.classification-api.html" class="wiki_link">incanter.classification</a></li><li><a href="incanter.core-api.html" class="wiki_link">incanter.core</a></li><li><a href="incanter.datasets-api.html" class="wiki_link">incanter.datasets</a></li><li><a href="incanter.incremental-stats-api.html" class="wiki_link">incanter.incremental-stats</a></li><li><a href="incanter.information-theory-api.html" class="wiki_link">incanter.information-theory</a></li><li><a href="incanter.internal-api.html" class="wiki_link">incanter.internal</a></li><li><a href="incanter.io-api.html" class="wiki_link">incanter.io</a></li><li><a href="incanter.optimize-api.html" class="wiki_link">incanter.optimize</a></li><li><a href="incanter.probability-api.html" class="wiki_link">incanter.probability</a></li><li><a href="incanter.processing-api.html" class="wiki_link">incanter.processing</a></li><li><a href="incanter.som-api.html" class="wiki_link">incanter.som</a></li><li><a href="incanter.stats-api.html" class="wiki_link">incanter.stats</a></li><li><a href="incanter.transformations-api.html" class="wiki_link">incanter.transformations</a></li>
    </ul>
  </div>
</div>
</div></div>
      <div id="rightcolumn">
	<div id="Content">
	  <div class="contentBox"><div class="innerContentBox">
              <div id="content_view" class="wiki wikiPage">
                <div id="right-sidebar"><div><div id="toc">
  <h1 class="nopad">Table of Contents</h1>
  <div style="margin-left: 1em;" class="toc-section">
    <a href="#toc0">Overview</a>
    <div style="margin-left: 1em;" class="toc-entry">
      <a href="#incanter.optimize/derivative">derivative</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#incanter.optimize/gradient">gradient</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#incanter.optimize/hessian">hessian</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#incanter.optimize/integrate">integrate</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#incanter.optimize/non-linear-model">non-linear-model</a>
    </div>
    <br />
  </div>
</div>
</div></div>
                <div id="content-tag"><div><h1 id="overview">API for <span id="namespace-name">incanter.optimize</span></h1>
by <span id="author">Unknown</span><br />
<br />Usage:
<pre>
(ns your-namespace
  (:require <span id="long-name">incanter.optimize</span>))
</pre><pre>
</pre><h2>Overview</h2>
<pre id="namespace-docstr"></pre>
<br />
<h2>Public Variables and Functions</h2>
<div id="var-entry">
  <br />
  <hr />
  <h2 id="incanter.optimize/derivative">derivative</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (derivative f &amp; options)
</pre>
  <pre id="var-docstr">
Returns a function that approximates the derivative of the given function.

Options:
  :dx (default 0.0001)

Examples:

  (use '(incanter core optimize charts stats))
  (defn cube [x] (* x x x))
  (def cube-deriv (derivative cube))
  (cube-deriv 2) ; value: 12.000600010022566
  (cube-deriv 3) ; value: 27.00090001006572
  (cube-deriv 4) ; value: 48.00120000993502

  (def x (range -3 3 0.1))
  (def plot (xy-plot x (map cube x)))
  (view plot)
  (add-lines plot x (map cube-deriv x))

  ;; get the second derivative function
  (def cube-deriv2 (derivative cube-deriv))
  (add-lines plot x (map cube-deriv2 x))

  ;; plot the normal pdf and its derivatives
  (def plot (xy-plot x (pdf-normal x)))
  (view plot)
  (def pdf-deriv (derivative pdf-normal))
  (add-lines plot x (pdf-deriv x))

  ;; plot the second derivative function
  (def pdf-deriv2 (derivative pdf-deriv))
  (add-lines plot x (pdf-deriv2 x))</pre>
  <a href="http://github.com/liebke/incanter/blob/9a69d1fe1dfdb36ee43a79cb8bc3e8784b3cc366/src/incanter/optimize.clj#L68" id="var-source">Source</a>
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="incanter.optimize/gradient">gradient</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (gradient f start &amp; options)
</pre>
  <pre id="var-docstr">
Returns a function that calculates a 5-point approximation to
the gradient of the given function. The vector of start values are
used to determine the number of parameters required by the function, and
to scale the step-size. The generated function accepts a vector of
parameter values and a vector of x data points and returns a matrix,
where each row is the gradient evaluated at the corresponding x value.

Examples:

  (use '(incanter core optimize datasets charts))
  (defn f [theta x]
    (+ (nth theta 0)
          (div (* x (- (nth theta 1) (nth theta 0)))
               (+ (nth theta 2) x))))

  (def start [20 200 100])
  (def data (to-matrix (get-dataset :thurstone)))
  (def x (sel data :cols 1))
  (def y (sel data :cols 0))
  ;; view the data
  (view (scatter-plot x y))

  (def grad (gradient f start))
  (time (doall (grad start x)))</pre>
  <a href="http://github.com/liebke/incanter/blob/9a69d1fe1dfdb36ee43a79cb8bc3e8784b3cc366/src/incanter/optimize.clj#L251" id="var-source">Source</a>
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="incanter.optimize/hessian">hessian</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (hessian f start &amp; options)
</pre>
  <pre id="var-docstr"> Returns a function that calculates an approximation to the Hessian matrix
of the given function. The vector of start values are used to determine
the number of parameters required by the function, and to scale the
step-size. The generated function accepts a vector of
parameter values and a vector of x data points and returns a matrix,
where each row with p*(p+1)/2 columns, one for each unique entry in
the Hessian evaluated at the corresponding x value.

Examples:

  (use '(incanter core optimize datasets charts))
  (defn f [theta x]
    (+ (nth theta 0)
          (div (* x (- (nth theta 1) (nth theta 0)))
               (+ (nth theta 2) x))))

  (def start [20 200 100])
  (def data (to-matrix (get-dataset :thurstone)))
  (def x (sel data :cols 1))
  (def y (sel data :cols 0))
  ;; view the data
  (view (scatter-plot x y))

  (time (def hess (hessian f start)))
  (time (doall (hess start x)))</pre>
  <a href="http://github.com/liebke/incanter/blob/9a69d1fe1dfdb36ee43a79cb8bc3e8784b3cc366/src/incanter/optimize.clj#L300" id="var-source">Source</a>
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="incanter.optimize/integrate">integrate</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (integrate f a b)
</pre>
  <pre id="var-docstr"> Integrate a function f from a to b


Examples:
  (defn f1 [x] 1)
  (defn f2 [x] (Math/pow x 2))
  (defn f3 [x] (* x (Math/exp (Math/pow x 2))))

  (integrate f1 0 5)
  (integrate f2 0 1)
  (integrate f3 0 1)

  ;; normal distribution
  (def std 1)
  (def mu 0)
  (defn normal [x]
    (/ 1
      (* (* std (Math/sqrt (* 2 Math/PI)))
        (Math/exp (/ (Math/pow (- (- x mu)) 2)
        (* 2 (Math/pow std 2)))))))

  (integrate normal 1.96 10)


Reference:
  http://jng.imagine27.com/articles/2009-04-09-161839_integral_calculus_in_lambda_calculus_lisp.html
  <a href="http://iam.elbenshira.com/archives/151_integral-calculus-in-haskell/">http://iam.elbenshira.com/archives/151_integral-calculus-in-haskell/</a></pre>
  <a href="http://github.com/liebke/incanter/blob/9a69d1fe1dfdb36ee43a79cb8bc3e8784b3cc366/src/incanter/optimize.clj#L26" id="var-source">Source</a>
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="incanter.optimize/non-linear-model">non-linear-model</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (non-linear-model f y x start &amp; options)
</pre>
  <pre id="var-docstr">
Determine the nonlinear least-squares estimates of the
parameters of a nonlinear model.
Based on R's nls (non-linear least squares) function.

Arguments:
  f -- model function, takes two argumetns the first a list of parameters
       that are to be estimated, and an x value.
  y -- sequence of dependent data
  x -- sequence of independent data
  start -- start values for the parameters to be estimated

Options:
  :method (default :gauss-newton) other option :newton-raphson
  :tol (default 1E-5)
  :max-iter (default 200)

Returns: a hash-map containing the following fields:
  :method -- the method used
  :coefs  -- the parameter estimates
  :gradient  -- the estimated gradient
  :hessian -- the estimated hessian, if available
  :iterations -- the number of iterations performed
  :fitted -- the fitted values of y (i.e. y-hat)
  :rss -- the residual sum-of-squares
  :x -- the independent data values
  :y -- the dependent data values


Examples:

  ;; example 1
  (use '(incanter core optimize datasets charts))
  ;; define the Michaelis-Menton model function
  ;; y = a + (b - a)*x/(c + x)
  (defn f [theta x]
    (let [[a b c] theta]
      (plus a (div (mult x (minus b a)) (plus c x)))))

  (def start [20 200 100])
  (def data (to-matrix (get-dataset :thurstone)))
  (def x (sel data :cols 1))
  (def y (sel data :cols 0))
  ;; view the data
  (def plot (scatter-plot x y))
  (view plot)

  (def nlm (non-linear-model f y x start))
  (add-lines plot x (:fitted nlm))


  ;; example 2
  (use '(incanter core optimize datasets charts))
  ;; Chwirut data set from NIST
  ;; http://www.itl.nist.gov/div898/strd/nls/data/LINKS/DATA/Chwirut1.dat
  (def data (to-matrix (get-dataset :chwirut)))
  (def x (sel data :cols 1))
  (def y (sel data :cols 0))

  ;; define model function: y = exp(-b1*x)/(b2+b3*x) + e
  (defn f [theta x]
    (let [[b1 b2 b3] theta]
      (div (exp (mult (minus b1) x)) (plus b2 (mult b3 x)))))

  (def plot (scatter-plot x y :legend true))
  (view plot)

  ;; the newton-raphson algorithm fails to converge to the correct solution
  ;; using first set of start values from NIST, but the default gauss-newton
  ;; algorith converges to the correct solution.

  (def start1 [0.1 0.01 0.02])
  (add-lines plot x (f start1 x))
  (def nlm1 (non-linear-model f y x start1))
  (add-lines plot x (:fitted nlm1))

  ;; both algorithms converges with second set of start values from NIST
  (def start2 [0.15 0.008 0.010])
  (add-lines plot x (f start2 x))
  (def nlm2 (non-linear-model f y x start2))
  (add-lines plot x (:fitted nlm2))</pre>
  <a href="http://github.com/liebke/incanter/blob/9a69d1fe1dfdb36ee43a79cb8bc3e8784b3cc366/src/incanter/optimize.clj#L588" id="var-source">Source</a>
</div>


</div></div>
              </div>
            </div>
          </div>
	</div>
	<div id="foot">
	  <div style="text-align: center;" id="copyright">No copyright info</div>
	</div>
      </div>
      <div id="DesignedBy">Logo &amp; site design by <a title="Visit Tom Hickey's website." href="http://www.tomhickey.com">Tom Hickey</a>.<br />
      Clojure auto-documentation system by Tom Faulhaber.</div>
    </div>
    <!-- /AllContentContainer -->
  </body>

</html>